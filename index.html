<!DOCTYPE html>
<html>
<head>
  <title>Simple Canvas Animation</title>
  </head>
<body>

<canvas id="animationCanvas" width="1000" height="700">


<script>
//==============================================================================
// global stuff

// set the bacgkround
let background = new Image();
background.src = "space3.jpg";

let c = document.getElementById("animationCanvas");
let ctx = c.getContext("2d");

// coordinates of circle that moves automatically
let x = c.width, y =Math.round(Math.random() * 700);

// coordinates of own player!
let playerX = 30, playerY = 200;

// radius of the ball
let radiusCircle = 25;

// number of lives
let numberOfLives = 3;

// score count
let score = 0;

// level
let currentLevel = 1;

// print out canvas height and width
console.log(c.width, c.height);

//======================================================================================
//ecma 6 notation with fat arrow
// draw is function name, () are arguments,
const draw = () => {
  // clear the canvas
  ctx.clearRect(0, 0, c.width, c.height);

  // draw the display
  ctx.drawImage(background, 0, 0);
  drawLives();
  drawScore();
  drawLevel();

  // start a new path;
  //  comment out begin and close path to see what happens
  ctx.beginPath();

  //  a circle at the coordinates
  ctx.arc(x, y, radiusCircle, 0, Math.PI * 2);
  ctx.fillStyle = "red";
  ctx.closePath();

  ctx.fill();

  // to move down you use y value
  // move right to left so subtract
  x = x - 5;

  // handle edge condition for the border
  if (x < radiusCircle) {
    x = c.width;
    y =Math.round(Math.random() * 700); // random place at right
  }

  // handle edge condition for the ball and the player
  // using distance formula
  // if it collides with playerball then reset it back to the right
  let num1 = x-playerX;
  let num2 = y-playerY;
  let dist = Math.sqrt(num1*num1 + num2*num2);
  if (dist < radiusCircle * 2) {
      x = c.width;
      y =Math.round(Math.random() * 700); // random place at right
  }

  // move the player
  playerBall();

  // call again when available
  window.requestAnimationFrame(draw);
}

//================================================================================================
// event listener for keyboard to move the ball
window.addEventListener("keydown",moveSomething, false);

// DOES NOT WORK
// function to put inside event listener
// ecma6? it doesnt work so i use the one underneath
const moveTheBall = (e) => {
    switch(e.keyCode) {
        case 38: // up
            playerY = playerY  - 5;
            break;

        case 40: // down
            playerY = playerY+5;
            break;
    }
    e.preventDefault();
}

// same as above but in regular js, still need to figure out how to do eca6 style notation
function moveSomething(e) {
    switch(e.keyCode) {
        case 38: // up
            playerY  = playerY  - 10;
            // edge detection to not go off the map
            if (playerY < radiusCircle) {
                playerY = radiusCircle;
            }
            break;

        case 40: // down
            playerY = playerY+10;
            // edge detection to not go off map
            if (playerY > c.height - radiusCircle) {
                playerY = c.height - radiusCircle;
            }
            break;
    }
    e.preventDefault();
}

// function to draw my ball and move it however i want
const playerBall = () => {
    ctx.beginPath();
    ctx.arc(playerX, playerY, radiusCircle,0,Math.PI*2);
    ctx.fillStyle = "#FFD700";
    ctx.closePath();
    ctx.fill();
}
//=====================================================================================================
// function to draw the number of lives on the screen
const drawLives = () => {
    ctx.font = "30px Arial";
    ctx.fillStyle = "#FFD700";
    ctx.fillText("Lives remaining: " + numberOfLives, 750, 670);
}

// function to draw the score
const drawScore = () => {
    ctx.font = "30px Arial";
    ctx.fillStyle = "#FFD700";
    ctx.fillText("Score: " + score, 400,50);
}

// function to draw the level
const drawLevel = () => {
    ctx.font = "30px Arial";
    ctx.fillStyle = "white";
    ctx.fillText("Level: " + currentLevel, 850,50);
}



//========================================================================================================
// kick it off
window.requestAnimationFrame(draw);


</script>

</body>
</html>
